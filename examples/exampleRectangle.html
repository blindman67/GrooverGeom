<!DOCTYPE html>
<html id="topDoc">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=ISO-8859-8">
        <title>Example template</title>
        <meta name="keywords" content="Geometry, Math, JavaScript, Mark Spronck, Groover, GrooverGeom" />
        <meta name="description" content="Example for the use of GrooverGeom.js. GrooverGeom is a Javascript geometry libarry" />
        <meta name="author" content="Mark Spronck" />
        <link rel="stylesheet" type="text/css" href="grooverGeomExamples.css">
        <script src = "http://localhost/MarksHome/GitHub/GrooverGeom/GrooverGeom.js"></script>
        <script src = "http://localhost/MarksHome/GitHub/GrooverGeom/GrooverGeom_ExtendRender.js"></script>
        <script src = "http://localhost/MarksHome/GitHub/GrooverGeom/GrooverGeom_ExtendShapes.js"></script>       
    </head>
    <body>
    <h1 class="exampleH1" >GrooverGeom Example</h1>
    <h2 class="exampleH2" >Primitive: groover.geom.Rectangle</h2>
    <div>
        <p>A rectangle is defined by a GrooverGeom.Line representing the top of the rectangle and a number called aspect that defines the height of the rectangle in terms of its width.</p>
                
        
        
        <table>
            <tr>
                <td>
                    <canvas class="exampleCanvas" id="mainCanvas" width = 500 height = 500></canvas>
                </td>
                <td>
                    <p>Move mouse over points and click drag to move them</p>
                    Info:
                    <ul>
                        <li>Mouse coords <span id="mouseCoords"></span></li>
                        <li>Mouse near index <span id="mouseNear"></span></li>
                        <li>Area : <span id="selectedArea"></span></li>
                        <li>Perimiter : <span id="selectedPerimiter"></span></li>
                        <li>Width : <span id="selectedWidth"></span></li>
                        <li>Height : <span id="selectedHeight"></span></li>
                        <li>Aspect : <span id="selectedAspect"></span></li>
                        <li>Inside : <span id="selectedInside"></span></li>
                        <li>Touching : <span id="selectedTouching"></span></li>
                        <li>
                            <span id="markerTypes"></span>
                        </li>
                        <li><span id="displayTypes"></span></li>
                    </ul>
                </td>
            </tr>
        </table>
    </div>
    
    
    <a  class="exampleA" href="index.html">Return to main</a>
    <script src = "mouse.js"></script>
    <script src = "imageHelper.js"></script>
    <script src = "domHelper.js"></script>
    <script src = "exampleCommonRun.js"></script>
    
    <script>
    "use strict";
    // activate drag points;
    setupDragPoints(); 
    
    var rectangles = new GG.PrimitiveArray(); // array of primitives
    
    // extra info display flags
    var showExtras = {
        boundingBox : true,
        boundingCircle : true,
        innerCircle : true,
        center : true,
    }
    var currentPrimitiveIndex = undefined;
    var currentPrimitive = undefined;
    
    // Update DOM display
    var displayExtrasClick = function(event){
        if(this.value === "Bounding_Box"){
            showExtras.boundingBox = this.checked;
        }
        if(this.value === "Bounding_Circle"){
            showExtras.boundingCircle = this.checked;
        }
        if(this.value === "Inner_Circle"){
            showExtras.innerCircle = this.checked;
        }
        if(this.value === "Center"){
            showExtras.center = this.checked;
        }
        console.log("Show unshow");
        
    }
    var displayExtras = addCheckBoxes(["Bounding Box","Bounding Circle","Inner Circle","Center"],"#displayTypes",displayExtrasClick);


    function exampleUpdate(time){
        var i;
        dragPointsUpdate();
        mouseInfoEl.textContent = mouseV.toString(0);
        if(currentDragPoint !== undefined){
            currentPrimitiveIndex = Math.floor(currentDragPoint/2);
            currentPrimitive = rectangles.primitives[currentPrimitiveIndex];
            selectedArea.innerHTML = currentPrimitive.area().toFixed(1) + " pixels<sup>2</sup>";
            selectedPerimiter.textContent = currentPrimitive.perimiter().toFixed(1) + " pixels";
            selectedWidth.textContent = currentPrimitive.width().toFixed(1) + " pixels";
            selectedHeight.textContent = currentPrimitive.height().toFixed(1) + " pixels";
            selectedAspect.textContent = currentPrimitive.aspect.toFixed(1);
            var str = "";
            var s = "";
            beginStyle("rgba(0,255,0,0.2)","black",1);
            rectangles.each(function(r,i){
                if(i !== currentPrimitiveIndex){
                    if(r.isRectangleInside(currentPrimitive)){
                        str += s + i;
                        s = ",";
                        r.moveTo().draw();

                    }
                }
             });
             ctx.fill();
             if(str === ""){
                selectedInside.textContent = "None.";
             }else{
                selectedInside.textContent = "rectangle/s " + str;
             }
            var str = "";
            var s = "";
            beginStyle("rgba(0,0,255,0.2)","black",1);
            rectangles.each(function(r,i){
                if(i !== currentPrimitiveIndex){
                    if(r.isRectangleTouching(currentPrimitive)){
                        str += s + i;
                        s = ",";
                        r.moveTo().draw();
                    }
                }
             });
             ctx.fill();
             if(str === ""){
                selectedTouching.textContent = "None.";
             }else{
                selectedTouching.textContent = "rectangle/s " + str;
             }
                
            
        }
        
        

        
        
        beginStyle("blue","White",3);
        rectangles.draw();            
        ctx.stroke();
        
        if(showExtras.boundingBox){
            beginStyle("blue","#ff0",1);
            
            rectangles.each(function(r){r.asBox().moveTo().draw()});
            rectangles.asBox().moveTo().draw();
            ctx.stroke();
         }
        if(showExtras.boundingCircle){
            beginStyle("blue","#f00",1);
            rectangles.each(function(r){r.asCircle().moveTo().draw()});
            ctx.stroke();
         }
        if(showExtras.innerCircle){
            beginStyle("blue","#00F",1);
            rectangles.each(function(r){r.asInnerCircle().moveTo().draw()});
            ctx.stroke();
         }
        if(showExtras.center){
            beginStyle("blue","#00F",1);
            rectangles.each(function(r){r.center().mark()});
            ctx.stroke();
         }
         
         if(currentPrimitive !== undefined){
            beginStyle("rgba(255,255,255,0.2)","Red",1);
            currentPrimitive.draw();
            ctx.fill();
            ctx.stroke();
         
         }

        

        

        beginFontStyle("arial",16,"black","center","middle");
        rectangles.lable();
    }
    
    
    function exampleStart(){
        // create drag points and add reactangles;
        var v,r;
        var points = [0.1,0.1,0.4,0.1,0.6,0.1,0.9,0.1,0.6,7/20,0.9,7/20];
        var aspects = [1,0.5,2];
        for(var i = 0; i < 6 ; i += 1){ // add some test points
            dragPoints.push(v = new GG.Vec(points[i*2]*w,points[i*2+1]*h));
            v.setLable(i);
        }
        for(var i = 0; i < 3 ; i += 1){ // add rectangles
            rectangles.push(r = new GG.Rectangle(new GG.Line(dragPoints.vecs[i * 2],dragPoints.vecs[i * 2 + 1]),aspects[i]));
            r.setLable("Rectangle "+ i);
        }
    }
    </script>
    </body>
</html>